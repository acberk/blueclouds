<html>

<head>
	<link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
	
	<ul id="tempList">
		<div class="spinner">
			<div class="bounce1"></div>
			<div class="bounce2"></div>
			<div class="bounce3"></div>
		</div>
	</ul>
</body>
<script>
	async function geoSuccess(pos) {

		let html = ``
		
		const { latitude, longitude } = pos.coords
		const response = await fetch(`https://api.weather.gov/points/${latitude.toFixed(4)},${longitude.toFixed(4)}/forecast/hourly`)
		const json = await response.json()

		const ul = document.getElementById('tempList')
		json.properties.periods.forEach(p => {
			html += `
				<li>
					<img src="${p.icon}"/>
					<span>${formatDate(p.startTime)}</span>
					<span>${p.temperature}Â°</span> 
				</li>
			`
		})

		ul.innerHTML = html
	}
	navigator.geolocation.getCurrentPosition(geoSuccess)

	function formatDate(date) {
		date = parseInt(/T(\d\d)/.exec(date)[1])
		if (date === 0) return '12 a'
		if (date === 12) return '12 p'
		if (date > 12) return `${date - 12} p`
		return `${date} a`
	}
</script>

</html>