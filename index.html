<html>

<head>

	<title>blueclouds</title>
	<link rel="stylesheet" type="text/css" href="main.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<link rel="apple-touch-icon-precomposed" sizes="57x57" href="images/apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="images/apple-touch-icon-60x60.png" />
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="images/apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/apple-touch-icon-152x152.png" />
	<link rel="icon" type="image/png" href="images/favicon-196x196.png" sizes="196x196" />
	<link rel="icon" type="image/png" href="images/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="images/favicon-16x16.png" sizes="16x16" />
	<link rel="icon" type="image/png" href="images/favicon-128.png" sizes="128x128" />
	<meta name="application-name" content="blueclouds"/>
	<meta name="msapplication-TileColor" content="#FFFFFF" />
	<meta name="msapplication-TileImage" content="images/mstile-144x144.png" />
	<meta name="msapplication-square70x70logo" content="images/mstile-70x70.png" />
	<meta name="msapplication-square150x150logo" content="images/mstile-150x150.png" />
	<meta name="msapplication-wide310x150logo" content="images/mstile-310x150.png" />
	<meta name="msapplication-square310x310logo" content="images/mstile-310x310.png" />


</head>

<body>

	<ul id="tempList">
		<li>
			<div class="spinner">
				<div class="bounce1"></div>
				<div class="bounce2"></div>
				<div class="bounce3"></div>
			</div>
		</li>
	</ul>
</body>
<script>
	const weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']

	async function geoSuccess(pos) {



		const { latitude, longitude } = pos.coords
		const response = await fetch(`https://api.weather.gov/points/${latitude.toFixed(4)},${longitude.toFixed(4)}/forecast/hourly`)
		const json = await response.json()
		const hourlyForecast = json.properties.periods

		let html = getWeekdayHtml(hourlyForecast[0].startTime)

		const ul = document.getElementById('tempList')
		hourlyForecast.forEach(p => {
			const startTime = formatDate(p.startTime)
			if (startTime === '12a') html += getWeekdayHtml(p.startTime)
			html += `
				<li class="hourly">
					<img src="${p.icon}"/>
					<span>${startTime}</span>
					<span>${p.temperature}Â°</span>
				</li>
			`
		})

		ul.innerHTML = html
	}
	navigator.geolocation.getCurrentPosition(geoSuccess)

	function formatDate(date) {
		date = parseInt(/T(\d\d)/.exec(date)[1])
		if (date === 0) return '12a'
		if (date === 12) return '12p'
		if (date > 12) return `${date - 12}p`
		return `${date}a`
	}

	function getWeekdayHtml(datetime) {
		datetime = new Date(datetime)
		const day = weekdays[datetime.getDay()]
		const month = datetime.getMonth() + 1
		const date = datetime.getDate()
		return `
			</ul><ul><li class="sticky">${day} ${month}/${date}</li>
		`
	}

</script>

</html>